---
title: Workplace Wage by City
output: 
    github_document:
        toc: true
---

```{R, warning=FALSE, results='hide', message=FALSE}
library(knitr)
library(readxl)
library(stargazer)
library(lmtest)
```

# Import Data

```{R, warning=FALSE, results='hide', message=FALSE}
rawGraduate <- read_excel("109cityu.xls")
rawWage <- read_excel("workplaceWageCity.xlsx")
```

```{R}
CITY <- cbind(rawWage["...1"], rawWage["109"], rawGraduate$...10[5:24])
colnames(CITY) <- c("city", "wage109", "graduate109")
CITY$graduate109 <- as.numeric(CITY$graduate109)
```

# SLR
```{R, results='hold'}
slr <- lm(CITY$wage109 ~ CITY$graduate109, )
summary(slr)
#stargazer(slr)
```

```{R}
plot(CITY$graduate109, CITY$wage109, main="2020 City Data", xlab="No. of Graduate", ylab="Average yearly wage ($10,000)")
text(CITY$graduate109[c(8,19)], CITY$wage109[c(8,19)], labels = c("Hsinchu County", "Hsinchu City"), cex = 0.6, pos = 4)
abline(slr)
```

# MLR

# Heteroskedaticity

## Test
We use the White Test for heteroskedaticity by specifying a formula with interaction term and sqaure term to the BP Test.
```{R}
bptest(slr, ~ CITY$graduate109 + I(CITY$graduate109^2))
```
Heteroskedaticity doesn't seem present.
## Robust